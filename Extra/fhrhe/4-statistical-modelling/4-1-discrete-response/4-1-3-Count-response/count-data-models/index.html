<!DOCTYPE html>
<html>
  <head>
    <title>Generalized linear model (GLM) : Poisson regression for count and rate – Hire Accredited Statistician Online | Ask for Statistics Help</title>

    
      

<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="content-language" content="en-gb">
<meta name="referrer" content="origin-when-crossorigin">
<meta name="msvalidate.01" content="6CF94B92C7D01E764F5BC3DDEB0B98FF" />
<meta name="yandex-verification" content="121c50dfaec756b0" />
<meta content="poisson, zero inflated, negative binomial, robust, overdispersion, risk ratio, generalized linear model, GLM, Quasi-poisson" name="keywords">
<meta name="revised" content="2019-02-17T18:41:40 GMT">
<meta name="description" content="Poisson regression model part of Generalized linear models (GLM), its statistical assumptions and interpretation (risk ratio). Also about zero-inflated,negative binomial and generalized poisson models" />
<meta name="title" content="Generalized linear model (GLM) : Poisson regression for count and rate – Hire Accredited Statistician Online | Ask for Statistics Help" />



<meta property="og:title" content="Generalized linear model (GLM) : Poisson regression for count and rate – Hire Accredited Statistician Online | Ask for Statistics Help"/>

<meta property="og:description" content="Poisson regression model part of Generalized linear models (GLM), its statistical assumptions and interpretation (risk ratio). Also about zero-inflated,negative binomial and generalized poisson models" />

<meta property="og:type" content="article" />

<meta property="og:url" content="/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/" />

<meta property="og:image" content="/images/cover.png" />


<meta property="og:image:secure_url" content="/images/cover.png" />

<meta property="fb:app_id" content="2107085849337279" />
<meta name="twitter:title" content="Generalized linear model (GLM) : Poisson regression for count and rate"/>

<meta name="twitter:description" content="Poisson regression model part of Generalized linear models (GLM), its statistical assumptions and interpretation (risk ratio). Also about zero-inflated,negative binomial and generalized poisson models"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content="/images/logo.png" />
<meta name="twitter:site" content="@Stat_online"/>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Generalized linear model (GLM) : Poisson regression for count and rate",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/"
  },
  "image": {
    "@type": "ImageObject",
    "url": "/images/cover.png",
    "width": 800,
    "height": 600
  },
  "genre": "4-Statistical-Modelling",
  "keywords": "Poisson, Quasi-poisson, Negative binomial, Zero inflated, GLM",
  "wordcount": 938,
  "url": "/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/",
  "datePublished": "2019-01-31T00:00:00+00:00",
  "dateModified": "2019-02-16T22:41:51+00:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "Chetan Prajapati",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/logo.png",
      "width": 127,
      "height": 40
    }
  },
  "author": {
    "@type": "Person",
    "name": "Chetan Prajapati"
  },
  "description": "Poisson regression model part of Generalized linear models (GLM), its statistical assumptions and interpretation (risk ratio). Also about zero-inflated,negative binomial and generalized poisson models"
}
</script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-134274550-1', 'auto');
	
	ga('send', 'pageview');
}
</script>




<link rel="canonical" href="/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/"/>
<link rel="alternate" href="/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/" hreflang="x-default" />
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/theme-original/style.css" rel="stylesheet">
<link href="/css/hybrid.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link rel="stylesheet" href="/css/bootstrap.min.css">


<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>





<script src="/js/jquery-3.3.1.min.js"></script>








    
  </head>
  <body data-url="/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="showVisitedLinks">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <p><img src="/images/logo.png" alt="Hire Accredited Statistician Online | Ask for Statistics Help" /></p>

  


    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="/js/lunr.min.js"></script>
		<script type="text/javascript" src="/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "\/";
        
		</script>
		<script type="text/javascript" src="/js/search.js"></script>
  </div>

      <ul class="topics">
            <li data-nav-id="/" class="dd-item">
            <a href="/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/1-data-management/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/1-data-management/"><b>1. </b>Data Management</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/1-data-management/reshaping-data-into-wide-or-long-format-in-r/" class="dd-item">
        <div>
          <a href="/1-data-management/reshaping-data-into-wide-or-long-format-in-r/">
            Reshaping
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/2-data-visualisation/" class="dd-item
        ">
      <div>
      <a href="/2-data-visualisation/"><b>2. </b>Data Visualisation</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/3-basic-statistics/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/3-basic-statistics/"><b>3. </b>Basic Statistics</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/3-basic-statistics/bootstrapping-parametric-and-non-parametric-bootstrap-using-loops-and-boot-function-in-r/" class="dd-item">
        <div>
          <a href="/3-basic-statistics/bootstrapping-parametric-and-non-parametric-bootstrap-using-loops-and-boot-function-in-r/">
            Bootstrap re-sampling
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/4-statistical-modelling/" class="dd-item parent alwaysopen haschildren
        ">
      <div>
      <a href="/4-statistical-modelling/"><b>4. </b>Statistical Models</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/4-statistical-modelling/4-1-discrete-response/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/4-statistical-modelling/4-1-discrete-response/"><b>4.1 </b>Discrete response</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/" class="dd-item active">
        <div>
          <a href="/4-statistical-modelling/4-1-discrete-response/4-1-3-count-response/count-data-models/">
            Count
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/4-statistical-modelling/4-2-continuous-response/" class="dd-item
        ">
      <div>
      <a href="/4-statistical-modelling/4-2-continuous-response/"><b>4.2 </b>Continuous response</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>



        <section id="shortcuts">
                <li class="" role="">Let's connect on><a href="https://twitter.com/Stat_online" target="_blank" rel="noopener"><i class='fa fa-twitter'>&nbsp;&nbsp;</i>Twitter</a></li>
                <li class="" role=""><a href="https://www.facebook.com/Statistician-Online-2287783558211416" target="_blank" rel="noopener"><i class='fa fa-facebook'>&nbsp;&nbsp;</i> Facebook</a></li>
                <li class="" role=""><a href="https://www.linkedin.com/in/statistical-evidence/" target="_blank" rel="noopener"><i class='fa fa-linkedin'>&nbsp;&nbsp;</i> Linkedin</a></li>
        </section>
            <a id="clear-history" class="" href="#" data-clear-history-toggle=""><i class="fa  fa-history"></i> Clear History</a>

    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        










 <a href='/'>Home</a> > <a href='/4-statistical-modelling/'>Statistical Models</a> > <a href='/4-statistical-modelling/4-1-discrete-response/'>Discrete response</a> > Generalized linear model (GLM) : Poisson regression for count and rate

 

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    
        </div>
    </div>
    

  </div>


  <div id="tags">
    
      <a class="label label-default" href="/tags/poisson">Poisson</a>
    
      <a class="label label-default" href="/tags/quasi-poisson">Quasi-poisson</a>
    
      <a class="label label-default" href="/tags/negative-binomial">Negative binomial</a>
    
      <a class="label label-default" href="/tags/zero-inflated">Zero inflated</a>
    
      <a class="label label-default" href="/tags/glm">GLM</a>
    
  </div>

<div id="body-inner">
  
    <h1>Generalized linear model (GLM) : Poisson regression for count and rate</h1>
  


    
    
    
    


<div id="what-is-a-count" class="section level3">
<h3>What is a count ?</h3>
<p>Count is a number which is <strong>discrete</strong> and <strong>non-negative</strong>. Discrete means a number which is a countable and distinct. For example, number of road accidents. Road accidents can be 2 or 852 but can not be 2.1 or 85.5. So its discrete i.e integer. This is different to numeric continuous variable (such as blood pressure 120.2,135.9) which modelled differently.</p>
<p>Count may also have contextual information i.e with time, area or length. Such as number of road accidents in given year, number of rain drops in square meter area. When the count is associated with any denominators, rate can be derived. For example, we observe 25 number of maternity claims from 850 women in year then the rate of claims will be 29 per 1000 women per year.</p>
</div>
<div id="probability-distributions-associated-with-the-count-random-variable" class="section level3">
<h3>Probability distribution(s) associated with the count random variable</h3>
<p>First we need to clarify what is a distribution.<strong>The Distribution is the specification of probability associated with the value taken by random variable on random experiment</strong>. For example, in random experiment of counting number of rain drops in square meter area. The random variable is number of rain drops. Once the experiment has been performed, we count the drop which may be 10. The random variable X taken the value of 10.We do this experiment again and its 35. So random variable X has taken the value of 35.</p>
<p>Now if we know the average rate of some event <span class="math inline">\([\lambda]\)</span> in which event happening indepdently in time. Then the number of event in any time period has poisson distribution.</p>
<p>For example, in neighborhood road, on avaerge 2 cars passing by every hour. We noted the number of cars passing by continuously for 24 hours. We may get following numbers</p>
<pre class="r"><code>set.seed(125)
rpois(24,2)</code></pre>
<pre><code>##  [1] 3 0 1 1 5 5 2 1 2 2 0 3 1 0 2 2 2 4 2 3 1 3 3 1</code></pre>
<p>We can derive the probability associated with each event and plot it with number of cars ( X axis ) and probability associated with it on Y axis</p>
<pre class="r"><code>set.seed(125)
X &lt;- rpois(24,2)
probs &lt;- dpois(X,2)
require(ggplot2)

ggplot(data.frame(X,probs), aes(X,probs)) + geom_bar(stat = &quot;identity&quot;) + scale_x_continuous(breaks=seq(0,5,by=1)) + theme_classic()</code></pre>
<p><img src="/4-Statistical-Modelling/4-1-Discrete-response/4-1-3-Count-response/2019-01-31-count-data-models_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>require(dummies)
x &lt;- sample(x=c(&quot;A&quot;,&quot;B&quot;),size=100, replace=TRUE, prob=c(0.5,0.5)) 
linpred &lt;- cbind(1, dummy(x)[, -1]) %*% c(0.2, 0.4) 
y  &lt;- exp(linpred) 
df &lt;- data.frame(x,y)
fit &lt;- glm(y~x,family = poisson(), df)
summary(fit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ x, family = poisson(), data = df)
## 
## Deviance Residuals: 
##        Min          1Q      Median          3Q         Max  
## -8.635e-09  -8.635e-09  -8.635e-09   0.000e+00   0.000e+00  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)   0.2000     0.1231   1.624   0.1043  
## xB            0.4000     0.1646   2.430   0.0151 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 5.9609e+00  on 99  degrees of freedom
## Residual deviance: 4.0263e-15  on 98  degrees of freedom
## AIC: Inf
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The prime distribution of count is poisson. The other models are available to overcome two majors issues in counts : over-dispersion (or less often under-dispersion) and excess zeros. Or sometime zero is impossible value for the outcome ( such length of stay-no 0 length of stay), in this condition, zero truncated model is useful.</p>
<p><strong>To overcome over or under dispersion:</strong></p>
<ul>
<li>Negative Binomial distribution (NB)</li>
<li>Poisson Inverse Gaussian (PIG)</li>
<li>Generalized Negative Binomial Model</li>
<li>Generalised Poisson</li>
<li>Heterogeneous Negative Binomial model (NB-H)</li>
</ul>
<p><strong>To ovecome excess zero’s:</strong></p>
<ul>
<li>zero-inflated Poisson (ZIP)</li>
<li>zero-inflated negative binomial (ZINB)</li>
<li>Hurdle model</li>
</ul>
<p><strong>To model outcome where 0 is impossible value</strong></p>
<ul>
<li>zero truncated models</li>
</ul>
<div class="figure">
<img src="/images/poisson_models_types.PNG" alt="Figure 1 Models for count data: mean-variance relationships and its parameterisation" />
<p class="caption">Figure 1 <strong>Models for count data: mean-variance relationships and its parameterisation</strong></p>
</div>
<div id="poisson-distribution" class="section level4">
<h4>1 Poisson distribution</h4>
<ul>
<li>single parameter</li>
<li>mean <span class="math inline">\([\mu]\)</span> is equal to variance <span class="math inline">\([\mu]\)</span>, also called dispersion</li>
<li>in real life datasets, more often there will be higher variability or correlation than model allows (over-dispersion) which leads to biased standard errors ( so as misleading significance of covariate)</li>
</ul>
</div>
<div id="negative-binomial" class="section level4">
<h4>2 Negative Binomial</h4>
<ul>
<li>has additional dispersion parameter <span class="math inline">\([\alpha]\)</span> to accommodate excess variability. when the dispersion parameter is zero,
the model becomes Poisson</li>
<li>can be traditional negative binomial (NB1) or quadratic negative binomial (NB2)</li>
<li>Only correct over-dispersion ( not under-dispersion of poisson)</li>
<li>form of Poisson-gamma mixture with dispersion parameter <span class="math inline">\([\alpha]\)</span> has gamma distribution. Gamma distribution is very flexible in shape so most (not all) dispersed count data modelled well with NB</li>
<li>It is possible that NB may not correct over-dispersion in a Poisson model</li>
</ul>
</div>
<div id="poisson-inverse-gaussian-pig" class="section level4">
<h4>3 Poisson Inverse Gaussian (PIG)</h4>
<ul>
<li>Similler to negative binomial except the dispersion parameter <span class="math inline">\([\alpha]\)</span> has inverse Gaussian distribution</li>
<li>Available in R <code>gamlass</code> package</li>
</ul>
</div>
<div id="generalized-negative-binomial-model-gnb" class="section level4">
<h4>4 Generalized Negative Binomial Model (GNB)</h4>
<ul>
<li>The GNB parametrizes the exponent on the second term of the
negative binomial variance.</li>
<li>To get initial idea whether data is suited to NB1 or NB2 or NB-P</li>
</ul>
</div>
<div id="generalised-poissson-models" class="section level4">
<h4>5 Generalised Poissson Models</h4>
<ul>
<li>Si miller to above models but dispersion parameter can take negative values which also correct under dispersion if present</li>
</ul>
</div>
<div id="heterogeneous-negative-binomail-model-nb-h" class="section level4">
<h4>6 Heterogeneous Negative Binomail model (NB-H)</h4>
<ul>
<li>Dispersion parameter can be associated with particular covariate which bring significant dispersion in the model.</li>
</ul>
</div>
<div id="exact-poisson-regression" class="section level4">
<h4>7 Exact poisson regression</h4>
<p>for unbalanced and sparse count data</p>
<p>In count model log of count are modelled with respect to linear predictors. This is will make sure that predicted count will always be positive.</p>
<p>The expected percentage of zero counts on the basis of the Poisson
model is under 1%. If mean of count response is 5 or below and some 30% of the count observations consist of zeros,ZIP or ZINB will be good choice.</p>
<p>Article is being updated …</p>
<p>Ref:</p>
<p>Hilbe, J. (2014). Modeling Count Data. Cambridge: Cambridge University Press. <a href="doi:10.1017/CBO9781139236065" class="uri">doi:10.1017/CBO9781139236065</a></p>
</div>
</div>


    
    
          
<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//https-chetan-prajapati-netlify-com.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/4-statistical-modelling/4-1-discrete-response/" title="Discrete response"> <i class="fa fa-chevron-left"></i><label>Discrete response</label></a>
    <a class="nav nav-next" href="/4-statistical-modelling/4-2-continuous-response/" title="Continuous response" style="margin-right: 0px;"><label>Continuous response</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script src="/js/featherlight.min.js"></script>
<script src="/js/html5shiv-printshiv.min.js"></script>

<script src="/js/modernizr.custom.71422.js"></script>
<script src="/js/docdock.js"></script>
<script src="/theme-original/script.js"></script>


    

    
    
    

    <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript"></script>
<script type="text/javascript">Calendly.initBadgeWidget({url: 'https://calendly.com/chetan-prajapati', text: "Book an appointment", color: "#191919", branding: false});</script>



  </body>
</html>